% exceltex.sty
% allows easy and transparent inclusion of contents of excel files in 
% latex documents.
% (C) 2004, 2005 by Hans-Peter Doerr <doerr@cip.physik.uni-freiburg.de>

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{exceltex}[2005/10/19 includes cells from Excel files]

\newcounter{exceltexCounterCel}
\newcounter{exceltexCounterTab}
\setcounter{exceltexCounterCel}{0}
\setcounter{exceltexCounterTab}{0}

\def\filename{\jobname-exceltex.idx}
\immediate\openout 10=\filename

\newcommand{\inccell}[1]{%
  \stepcounter{exceltexCounterCel}%
  \immediate\write 10{\theexceltexCounterCel:c:#1}%
  \InputIfFileExists{.exceltex-\jobname-c-\theexceltexCounterCel}{}{}%
}%

\newcommand{\inctab}[1]{%
  \stepcounter{exceltexCounterTab}%
  \immediate\write 10{\theexceltexCounterTab:t:#1}%
  \InputIfFileExists{.exceltex-\jobname-t-\theexceltexCounterTab}{}{\\}%
}%
